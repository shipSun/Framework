<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <title>PHPUnit 手册 &#8211; 第 13 章 PHPUnit 与 Selenium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="canonical" href="https://phpunit.de/manual/current/zh_cn/selenium.html">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/highlight.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700%7CSource+Code+Pro:400,700' rel='stylesheet' type='text/css'>
  <!--[if lt IE 9]><script src="js/html5shiv.min.js"></script><![endif]-->
 </head>
 <body>
  <nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav navbar-left"><li><a href="https://phpunit.de/">PHPUnit</a></li><li><a href="../../5.0/zh_cn/index.html">5.0 (alpha)</a></li><li><a href="../../4.8/zh_cn/index.html">4.8 (beta)</a></li><li class="active"><a href="../../4.7/zh_cn/index.html">4.7 (<strong>stable</strong>)</a></li></ul>
      <ul class="nav navbar-nav navbar-right"><li><a href="../en/index.html">English</a></li><li><a href="../ja/index.html">Japanese</a></li><li><a href="../pt_br/index.html">Brazilian Portuguese</a></li><li class="active"><a href="../zh_cn/index.html">Simplified Chinese</a></li></ul>
    </div>
  </nav>
  <div class="container-fluid">
   <div class="row">
    <div class="col-md-4 col-lg-3">
     <div class="well well-sm sidebar-nav">
<dl class="toc nav hidden-print"><dt><span class="chapter"><a href="installation.html">1. 安装 PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="installation.html#installation.requirements">需求</a></span></dt><dt><span class="section"><a href="installation.html#installation.phar">PHP 档案包 (PHAR)</a></span></dt><dd><dl><dt><span class="section"><a href="installation.html#installation.phar.windows">Windows</a></span></dt><dt><span class="section"><a href="installation.html#installation.phar.verification">校验 PHPUnit PHAR 发行包</a></span></dt></dl></dd><dt><span class="section"><a href="installation.html#installation.composer">Composer</a></span></dt><dt><span class="section"><a href="installation.html#installation.optional-packages">可选的组件包</a></span></dt></dl></dd><dt><span class="chapter"><a href="writing-tests-for-phpunit.html">2. 编写 PHPUnit 测试</a></span></dt><dd><dl><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.test-dependencies">测试的依赖关系</a></span></dt><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.data-providers">数据供给器</a></span></dt><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.exceptions">对异常进行测试</a></span></dt><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.errors">对 PHP 错误进行测试</a></span></dt><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.output">对输出进行测试</a></span></dt><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.error-output">错误相关信息的输出</a></span></dt><dd><dl><dt><span class="section"><a href="writing-tests-for-phpunit.html#writing-tests-for-phpunit.error-output.edge-cases">边缘情况</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="textui.html">3. 命令行测试执行器</a></span></dt><dd><dl><dt><span class="section"><a href="textui.html#textui.clioptions">命令行选项</a></span></dt></dl></dd><dt><span class="chapter"><a href="fixtures.html">4. 基境(fixture)</a></span></dt><dd><dl><dt><span class="section"><a href="fixtures.html#fixtures.more-setup-than-teardown">setUp() 多 tearDown() 少</a></span></dt><dt><span class="section"><a href="fixtures.html#fixtures.variations">变体</a></span></dt><dt><span class="section"><a href="fixtures.html#fixtures.sharing-fixture">基境共享</a></span></dt><dt><span class="section"><a href="fixtures.html#fixtures.global-state">全局状态</a></span></dt></dl></dd><dt><span class="chapter"><a href="organizing-tests.html">5. 组织测试</a></span></dt><dd><dl><dt><span class="section"><a href="organizing-tests.html#organizing-tests.filesystem">用文件系统来编排测试套件</a></span></dt><dt><span class="section"><a href="organizing-tests.html#organizing-tests.xml-configuration">用 XML 配置来编排测试套件</a></span></dt></dl></dd><dt><span class="chapter"><a href="risky-tests.html">6. 有风险的测试</a></span></dt><dd><dl><dt><span class="section"><a href="risky-tests.html#risky-tests.useless-tests">无用测试</a></span></dt><dt><span class="section"><a href="risky-tests.html#risky-tests.unintentionally-covered-code">意外的代码覆盖</a></span></dt><dt><span class="section"><a href="risky-tests.html#risky-tests.output-during-test-execution">测试执行期间产生的输出</a></span></dt><dt><span class="section"><a href="risky-tests.html#risky-tests.test-execution-timeout">测试执行时长的超时限制</a></span></dt><dt><span class="section"><a href="risky-tests.html#risky-tests.global-state-manipulation">全局状态篡改</a></span></dt></dl></dd><dt><span class="chapter"><a href="incomplete-and-skipped-tests.html">7. 未完成的测试与跳过的测试</a></span></dt><dd><dl><dt><span class="section"><a href="incomplete-and-skipped-tests.html#incomplete-and-skipped-tests.incomplete-tests">未完成的测试</a></span></dt><dt><span class="section"><a href="incomplete-and-skipped-tests.html#incomplete-and-skipped-tests.skipping-tests">跳过测试</a></span></dt><dt><span class="section"><a href="incomplete-and-skipped-tests.html#incomplete-and-skipped-tests.skipping-tests-using-requires">用 @requires 来跳过测试</a></span></dt></dl></dd><dt><span class="chapter"><a href="database.html">8. 数据库测试</a></span></dt><dd><dl><dt><span class="section"><a href="database.html#database.supported-vendors-for-database-testing">数据库测试所支持的供应商</a></span></dt><dt><span class="section"><a href="database.html#database.difficulties-in-database-testing">数据库测试的难点</a></span></dt><dt><span class="section"><a href="database.html#database.the-four-stages-of-a-database-test">数据库测试的四个阶段</a></span></dt><dd><dl><dt><span class="section"><a href="database.html#database.clean-up-database">1. 清理数据库</a></span></dt><dt><span class="section"><a href="database.html#database.set-up-fixture">2. 建立基境</a></span></dt><dt><span class="section"><a href="database.html#database.run-test-verify-outcome-and-teardown">3–5. 运行测试、验证结果、并拆除基境</a></span></dt></dl></dd><dt><span class="section"><a href="database.html#database.configuration-of-a-phpunit-database-testcase">PHPUnit 数据库测试用例的配置</a></span></dt><dd><dl><dt><span class="section"><a href="database.html#database.implementing-getconnection">实现 getConnection()</a></span></dt><dt><span class="section"><a href="database.html#database.implementing-getdataset">实现 getDataSet()</a></span></dt><dt><span class="section"><a href="database.html#database.what-about-the-database-schema-ddl">数据库构架(DDL)怎么办？</a></span></dt><dt><span class="section"><a href="database.html#database.tip-use-your-own-abstract-database-testcase">小建议：使用你自己的抽象数据库 TestCase 类</a></span></dt></dl></dd><dt><span class="section"><a href="database.html#database.understanding-datasets-and-datatables">理解 DataSet（数据集）和 DataTable（数据表）</a></span></dt><dd><dl><dt><span class="section"><a href="database.html#database.available-implementations">可用的各种实现</a></span></dt><dt><span class="section"><a href="database.html#database.beware-of-foreign-keys">当心外键</a></span></dt><dt><span class="section"><a href="database.html#database.implementing-your-own-datasetsdatatables">实现自有的 DataSet/DataTable</a></span></dt></dl></dd><dt><span class="section"><a href="database.html#database.the-connection-api">数据库连接 API</a></span></dt><dt><span class="section"><a href="database.html#database.database-assertions-api">数据库断言 API</a></span></dt><dd><dl><dt><span class="section"><a href="database.html#database.asserting-the-row-count-of-a-table">对表中数据行的数量作出断言</a></span></dt><dt><span class="section"><a href="database.html#database.asserting-the-state-of-a-table">对表的状态作出断言</a></span></dt><dt><span class="section"><a href="database.html#database.asserting-the-result-of-a-query">对查询的结果作出断言</a></span></dt><dt><span class="section"><a href="database.html#database.asserting-the-state-of-multiple-tables">对多个表的状态作出断言</a></span></dt></dl></dd><dt><span class="section"><a href="database.html#database.frequently-asked-questions">常见问题（FAQ）</a></span></dt><dd><dl><dt><span class="section"><a href="database.html#database.will-phpunit-re-create-the-database-schema-for-each-test">PHPUnit 会为每个测试（重新）创建数据库吗？</a></span></dt><dt><span class="section"><a href="database.html#database.am-i-required-to-use-pdo-in-my-application-for-the-database-extension-to-work">为了让数据库扩展模块正常工作，需要在应用程序中使用 PDO 吗？</a></span></dt><dt><span class="section"><a href="database.html#database.what-can-i-do-when-i-get-a-too-much-connections-error">如果看到 <span class="quote">“<span class="quote">Too much Connections</span>”</span> 错误该怎么办？</a></span></dt><dt><span class="section"><a href="database.html#database.how-to-handle-null-with-flat-xml-csv-datasets">Flat XML / CSV 数据集中如何处理 NULL？</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="test-doubles.html">9. 测试替身</a></span></dt><dd><dl><dt><span class="section"><a href="test-doubles.html#test-doubles.stubs">桩件(Stub)</a></span></dt><dt><span class="section"><a href="test-doubles.html#test-doubles.mock-objects">仿件对象(Mock Object)</a></span></dt><dt><span class="section"><a href="test-doubles.html#test-doubles.prophecy">Prophecy</a></span></dt><dt><span class="section"><a href="test-doubles.html#test-doubles.mocking-traits-and-abstract-classes">对特质(Trait)与抽象类进行模仿</a></span></dt><dt><span class="section"><a href="test-doubles.html#test-doubles.stubbing-and-mocking-web-services">对 Web 服务(Web Services)进行上桩或模仿&lt;</a></span></dt><dt><span class="section"><a href="test-doubles.html#test-doubles.mocking-the-filesystem">对文件系统进行模仿</a></span></dt></dl></dd><dt><span class="chapter"><a href="testing-practices.html">10. 测试实践</a></span></dt><dd><dl><dt><span class="section"><a href="testing-practices.html#testing-practices.during-development">在开发过程中</a></span></dt><dt><span class="section"><a href="testing-practices.html#testing-practices.during-debugging">在调试过程中</a></span></dt></dl></dd><dt><span class="chapter"><a href="code-coverage-analysis.html">11. 代码覆盖率分析</a></span></dt><dd><dl><dt><span class="section"><a href="code-coverage-analysis.html#code-coverage-analysis.metrics">用于代码覆盖率的软件衡量标准</a></span></dt><dt><span class="section"><a href="code-coverage-analysis.html#code-coverage-analysis.including-excluding-files">包含与排除文件</a></span></dt><dt><span class="section"><a href="code-coverage-analysis.html#code-coverage-analysis.ignoring-code-blocks">略过代码块</a></span></dt><dt><span class="section"><a href="code-coverage-analysis.html#code-coverage-analysis.specifying-covered-methods">指明要覆盖的方法</a></span></dt><dt><span class="section"><a href="code-coverage-analysis.html#code-coverage-analysis.edge-cases">边缘情况</a></span></dt></dl></dd><dt><span class="chapter"><a href="other-uses-for-tests.html">12. 测试的其他用途</a></span></dt><dd><dl><dt><span class="section"><a href="other-uses-for-tests.html#other-uses-for-tests.agile-documentation">敏捷文档</a></span></dt><dt><span class="section"><a href="other-uses-for-tests.html#other-uses-for-tests.cross-team-tests">跨团队测试</a></span></dt></dl></dd><dt><span class="chapter"><a href="selenium.html" class="active">13. PHPUnit 与 Selenium</a></span></dt><dd><dl><dt><span class="section"><a href="selenium.html#selenium.selenium-rc">Selenium Server</a></span></dt><dt><span class="section"><a href="selenium.html#selenium.installation">安装</a></span></dt><dt><span class="section"><a href="selenium.html#selenium.selenium2testcase">PHPUnit_Extensions_Selenium2TestCase</a></span></dt><dt><span class="section"><a href="selenium.html#selenium.seleniumtestcase">PHPUnit_Extensions_SeleniumTestCase</a></span></dt></dl></dd><dt><span class="chapter"><a href="logging.html">14. 日志记录</a></span></dt><dd><dl><dt><span class="section"><a href="logging.html#logging.xml">测试结果 (XML)</a></span></dt><dt><span class="section"><a href="logging.html#logging.tap">测试结果 (TAP)</a></span></dt><dt><span class="section"><a href="logging.html#logging.json">测试结果 (JSON)</a></span></dt><dt><span class="section"><a href="logging.html#logging.codecoverage.xml">代码覆盖率 (XML)</a></span></dt><dt><span class="section"><a href="logging.html#logging.codecoverage.text">代码覆盖率 (TEXT)</a></span></dt></dl></dd><dt><span class="chapter"><a href="extending-phpunit.html">15. 扩展 PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="extending-phpunit.html#extending-phpunit.PHPUnit_Framework_TestCase">从 PHPUnit_Framework_TestCase 派生子类</a></span></dt><dt><span class="section"><a href="extending-phpunit.html#extending-phpunit.custom-assertions">编写自定义断言</a></span></dt><dt><span class="section"><a href="extending-phpunit.html#extending-phpunit.PHPUnit_Framework_TestListener">实现 PHPUnit_Framework_TestListener</a></span></dt><dt><span class="section"><a href="extending-phpunit.html#extending-phpunit.PHPUnit_Extensions_TestDecorator">从 PHPUnit_Extensions_TestDecorator 派生子类</a></span></dt><dt><span class="section"><a href="extending-phpunit.html#extending-phpunit.PHPUnit_Framework_Test">实现 PHPUnit_Framework_Test</a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.assertions.html">A. 断言</a></span></dt><dd><dl><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertArrayHasKey">assertArrayHasKey()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertArraySubset">assertArraySubset()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertClassHasAttribute">assertClassHasAttribute()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertClassHasStaticAttribute">assertClassHasStaticAttribute()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertContains">assertContains()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertContainsOnly">assertContainsOnly()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertContainsOnlyInstancesOf">assertContainsOnlyInstancesOf()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertCount">assertCount()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertEmpty">assertEmpty()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertEqualXMLStructure">assertEqualXMLStructure()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertEquals">assertEquals()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertFalse">assertFalse()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertFileEquals">assertFileEquals()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertFileExists">assertFileExists()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertGreaterThan">assertGreaterThan()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertGreaterThanOrEqual">assertGreaterThanOrEqual()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertInstanceOf">assertInstanceOf()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertInternalType">assertInternalType()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertJsonFileEqualsJsonFile">assertJsonFileEqualsJsonFile()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertJsonStringEqualsJsonFile">assertJsonStringEqualsJsonFile()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertJsonStringEqualsJsonString">assertJsonStringEqualsJsonString()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertLessThan">assertLessThan()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertLessThanOrEqual">assertLessThanOrEqual()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertNull">assertNull()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertObjectHasAttribute">assertObjectHasAttribute()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertRegExp">assertRegExp()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertStringMatchesFormat">assertStringMatchesFormat()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertStringMatchesFormatFile">assertStringMatchesFormatFile()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertSame">assertSame()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertStringEndsWith">assertStringEndsWith()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertStringEqualsFile">assertStringEqualsFile()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertStringStartsWith">assertStringStartsWith()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertThat">assertThat()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertTrue">assertTrue()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertXmlFileEqualsXmlFile">assertXmlFileEqualsXmlFile()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertXmlStringEqualsXmlFile">assertXmlStringEqualsXmlFile()</a></span></dt><dt><span class="section"><a href="appendixes.assertions.html#appendixes.assertions.assertXmlStringEqualsXmlString">assertXmlStringEqualsXmlString()</a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.annotations.html">B. 标注</a></span></dt><dd><dl><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.author">@author</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.after">@after</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.afterClass">@afterClass</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.backupGlobals">@backupGlobals</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.backupStaticAttributes">@backupStaticAttributes</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.before">@before</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.beforeClass">@beforeClass</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.covers">@covers</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.coversDefaultClass">@coversDefaultClass</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.coversNothing">@coversNothing</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.dataProvider">@dataProvider</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.depends">@depends</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.expectedException">@expectedException</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.expectedExceptionCode">@expectedExceptionCode</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.expectedExceptionMessage">@expectedExceptionMessage</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.expectedExceptionMessageRegExp">@expectedExceptionMessageRegExp</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.group">@group</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.large">@large</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.medium">@medium</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.preserveGlobalState">@preserveGlobalState</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.requires">@requires</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.runTestsInSeparateProcesses">@runTestsInSeparateProcesses</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.runInSeparateProcess">@runInSeparateProcess</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.small">@small</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.test">@test</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.testdox">@testdox</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.ticket">@ticket</a></span></dt><dt><span class="section"><a href="appendixes.annotations.html#appendixes.annotations.uses">@uses</a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.configuration.html">C. XML 配置文件</a></span></dt><dd><dl><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.phpunit">PHPUnit</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.testsuites">测试套件</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.groups">分组</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.blacklist-whitelist">为代码覆盖率包含或排除文件</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.logging">Logging （日志记录）</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.test-listeners">测试监听器</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.php-ini-constants-variables">设定 PHP INI 设置、常量、全局变量</a></span></dt><dt><span class="section"><a href="appendixes.configuration.html#appendixes.configuration.selenium-rc">为 Selenium RC 配置浏览器</a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.upgrading.html">D. 升级</a></span></dt><dd><dl><dt><span class="section"><a href="appendixes.upgrading.html#appendixes.upgrading.phpunit-4-0">从 PHPUnit 3.7 升级到 PHPUnit 4.0</a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.index.html">E. 索引</a></span></dt><dd><dl><dt><span class="index"><a href="appendixes.index.html#appendixes.index.index"></a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.bibliography.html">F. 参考书目</a></span></dt><dt><span class="appendix"><a href="appendixes.copyright.html">G. 版权</a></span></dt></dl>
     </div>
    </div>
    <div class="col-md-8 col-lg-9">
     <div class="row">
      <div class="col-md-1 pull-left prev-nav"><a accesskey="p" href="other-uses-for-tests.html">上一章</a></div>
      <div class="col-md-1 pull-right next-nav"><a accesskey="n" href="logging.html">下一章</a></div>
     </div>
<div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="selenium"></a>第 13 章 PHPUnit 与 Selenium</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.selenium-rc"></a>Selenium Server</h2></div></div></div><p>
      <a id="idp894256" class="indexterm"></a>

      <a class="ulink" href="http://seleniumhq.org/" target="_top">Selenium Server</a>是一个测试工具，它允许用任意主流浏览器为任意 HTTP 网站上的用任意编程语言开发的 web 应用程序编写自动用户界面测试。它通过操作系统来驱动浏览器进程来执行自动测试。Selenium 测试直接运行于某个浏览器中，就和真实用户一样。这些测试既可以用于 <span class="emphasis"><em>验收测试</em></span>（通过在集成好的系统中执行较高层面的测试而非仅对系统的各个单元分别单独测试。）也可以用于<span class="emphasis"><em>浏览器兼容性测试</em></span>（通过在不同的操作系统与浏览器上对 web 应用程序进行测试）。</p><p>PHPUnit_Selenium 只支持 Selenium 2.x 服务器的脚本。服务器可以通过从 1.x 就提供的传统 Selenium RC API 访问，也可以从 PHPUnit_Selenium 1.2 用 WebDriver API（部分实现）访问。</p><p>这个决定的原因是 Selenium 2 是向后兼容的，而 Selenium RC 已经不再维护了。</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.installation"></a>安装</h2></div></div></div><p>首先，安装 Selenium Server：</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">下载 <a class="ulink" href="http://seleniumhq.org/download/" target="_top">Selenium Server</a> 的分发档。</li><li class="listitem">将分发档解压，然后将 <code class="filename">selenium-server-standalone-2.9.0.jar</code>（注意版本后缀） 复制到合适的位置，比如说 <code class="filename">/usr/local/bin</code>。</li><li class="listitem">运行 <strong class="userinput"><code>java -jar /usr/local/bin/selenium-server-standalone-2.9.0.jar</code></strong> 来启动 Selenium Server 服务器端。</li></ol></div><p>PHPUnit 的 PHAR 分发中已经包含了 PHPUnit_Selenium 组件包。若要通过 Composer 安装此组件包，添加如下 <code class="literal">"require-dev"</code> 依赖项：</p><pre class="screen"><strong class="userinput"><code>"phpunit/phpunit-selenium": "&gt;=1.2"</code></strong></pre><p>现在可以用 Selenium Server 的客户端/服务器端协议来向它发送命令了。</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.selenium2testcase"></a>PHPUnit_Extensions_Selenium2TestCase</h2></div></div></div><p>
      <a id="idp866400" class="indexterm"></a>通过 <code class="literal">PHPUnit_Extensions_Selenium2TestCase</code> 测试用例能够使用 WebDriver API（部分实现）。</p><p>
      <a class="xref" href="selenium.html#selenium.selenium2testcase.examples.WebTest.php" title="例 13.1: PHPUnit_Extensions_Selenium2TestCase 的用法示例">例 13.1</a>展示了如何对 <code class="systemitem">http://www.example.com/</code> 网站 <code class="literal">&lt;title&gt;</code> 元素的内容进行测试。</p><div class="example"><a id="selenium.selenium2testcase.examples.WebTest.php"></a><p class="title"><strong>例 13.1: PHPUnit_Extensions_Selenium2TestCase 的用法示例</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class WebTest extends PHPUnit_Extensions_Selenium2TestCase
{
    protected function setUp()
    {
        $this-&gt;setBrowser('firefox');
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;url('http://www.example.com/');
        $this-&gt;assertEquals('Example WWW Page', $this-&gt;title());
    }

}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 4.7.0 by Sebastian Bergmann and contributors.

F

Time: 28 seconds, Memory: 3.00Mb

There was 1 failure:

1) WebTest::testTitle
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'Example WWW Page'
+'IANA — Example domains'

/home/giorgio/WebTest.php:13

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break"></br><p>Selenium2TestCase 的命令是通过 __call() 来实现的。请参考 <a class="ulink" href="https://github.com/sebastianbergmann/phpunit-selenium/blob/master/Tests/Selenium2TestCaseTest.php" target="_top">the end-to-end test for PHPUnit_Extensions_Selenium2TestCase</a> 以获取所有受支持的特性的列表。</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.seleniumtestcase"></a>PHPUnit_Extensions_SeleniumTestCase</h2></div></div></div><p>
      <a id="idp963168" class="indexterm"></a><code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>  测试用例扩展实现了客户端/服务器端协议来与 Selenium Server 沟通，同时还为 web 测试实现了一些特殊的断言方法。</p><p>
      <a class="xref" href="selenium.html#selenium.seleniumtestcase.examples.WebTest.php" title="例 13.2: PHPUnit_Extensions_SeleniumTestCase 的用法示例">例 13.2</a>展示了如何对 <code class="systemitem">http://www.example.com/</code> 网站 <code class="literal">&lt;title&gt;</code> 元素的内容进行测试。</p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest.php"></a><p class="title"><strong>例 13.2: PHPUnit_Extensions_SeleniumTestCase 的用法示例</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    protected function setUp()
    {
        $this-&gt;setBrowser('*firefox');
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;open('http://www.example.com/');
        $this-&gt;assertTitle('Example WWW Page');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 4.7.0 by Sebastian Bergmann and contributors.

F

Time: 9 seconds, Memory: 6.00Mb

There was 1 failure:

1) WebTest::testTitle
Current URL: http://www.iana.org/domains/example/

Failed asserting that 'IANA — Example domains' matches PCRE pattern "/Example WWW Page/".


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break"></br><p>与 <code class="literal">PHPUnit_Framework_TestCase</code> 类不同，扩展自 <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> 的测试用例类必须提供 <code class="literal">setUp()</code> 方法。这个方法用来配置 Selenium Server 会话。<a class="xref" href="selenium.html#selenium.seleniumtestcase.tables.seleniumrc-api.setup" title="表 13.1. Selenium Server API: 设置">表 13.1</a> 中列出了所有用于这方面的方法。</p><div class="table"><a id="selenium.seleniumtestcase.tables.seleniumrc-api.setup"></a><p class="title"><strong>表 13.1. Selenium Server API: 设置</strong></p><div class="table-contents"><table summary="Selenium Server API: 设置" border="1"><colgroup><col></col><col></col></colgroup><thead><tr><th align="left">方法</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left"><code class="literal">void setBrowser(string $browser)</code></td><td align="left">设置用于 Selenium Server 服务器的浏览器。</td></tr><tr><td align="left"><code class="literal">void setBrowserUrl(string $browserUrl)</code></td><td align="left">设置测试的基准 URL (base URL)。</td></tr><tr><td align="left"><code class="literal">void setHost(string $host)</code></td><td align="left">设定 Selenium Server 服务器连接的主机名。</td></tr><tr><td align="left"><code class="literal">void setPort(int $port)</code></td><td align="left">设定 Selenium Server 服务器连接的端口号。</td></tr><tr><td align="left"><code class="literal">void setTimeout(int $timeout)</code></td><td align="left">设定 Selenium Server 服务器连接的超时时间。</td></tr><tr><td align="left"><code class="literal">void setSleep(int $seconds)</code></td><td align="left">设定 Selenium Server 客户端向 Selenium Server 服务器端发送动作多个命令之间需要休眠的秒数</td></tr></tbody></table></div></div><br class="table-break"></br><p>PHPUnit 还可以在 Selenium 测试失败时截屏。要启用这个功能，在测试用例类里设置 <code class="literal">$captureScreenshotOnFailure</code>、<code class="literal">$screenshotPath</code> 和 <code class="literal">$screenshotUrl</code>，如<a class="xref" href="selenium.html#selenium.seleniumtestcase.examples.WebTest2.php" title="例 13.3: 当测试失败时截屏">例 13.3</a>中所示。</p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest2.php"></a><p class="title"><strong>例 13.3: 当测试失败时截屏</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    protected $captureScreenshotOnFailure = TRUE;
    protected $screenshotPath = '/var/www/localhost/htdocs/screenshots';
    protected $screenshotUrl = 'http://localhost/screenshots';

    protected function setUp()
    {
        $this-&gt;setBrowser('*firefox');
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;open('http://www.example.com/');
        $this-&gt;assertTitle('Example WWW Page');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 4.7.0 by Sebastian Bergmann and contributors.

F

Time: 7 seconds, Memory: 6.00Mb

There was 1 failure:

1) WebTest::testTitle
Current URL: http://www.iana.org/domains/example/
Screenshot: http://localhost/screenshots/334b080f2364b5f11568ee1c7f6742c9.png

Failed asserting that 'IANA — Example domains' matches PCRE pattern "/Example WWW Page/".


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break"></br><p>可以对每个测试都用一组浏览器运行：不要用 <code class="literal">setBrowser()</code> 来设定单个浏览器，而是在测试用例类里声明一个名称为<code class="literal">$browsers</code> 的 <code class="literal">public static</code> 数组。这个数组里的每个项目都描述了一个浏览器配置。这些浏览器可以各自由不同的 Selenium Server 服务器承载。<a class="xref" href="selenium.html#selenium.seleniumtestcase.examples.WebTest3.php" title="例 13.4: 设置多个浏览器配置">例 13.4</a> 展示了例子。</p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest3.php"></a><p class="title"><strong>例 13.4: 设置多个浏览器配置</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    public static $browsers = array(
      array(
        'name'    =&gt; 'Firefox on Linux',
        'browser' =&gt; '*firefox',
        'host'    =&gt; 'my.linux.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      ),
      array(
        'name'    =&gt; 'Safari on MacOS X',
        'browser' =&gt; '*safari',
        'host'    =&gt; 'my.macosx.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      ),
      array(
        'name'    =&gt; 'Safari on Windows XP',
        'browser' =&gt; '*custom C:\Program Files\Safari\Safari.exe -url',
        'host'    =&gt; 'my.windowsxp.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      ),
      array(
        'name'    =&gt; 'Internet Explorer on Windows XP',
        'browser' =&gt; '*iexplore',
        'host'    =&gt; 'my.windowsxp.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      )
    );

    protected function setUp()
    {
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;open('http://www.example.com/');
        $this-&gt;assertTitle('Example Web Page');
    }
}
?&gt;</pre></div></div><br class="example-break"></br><p>
      <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> 可以为通过 Selenium 运行的测试收集代码覆盖率信息：</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">将 <code class="filename">PHPUnit/Extensions/SeleniumCommon/phpunit_coverage.php</code> 复制到 web 服务器文档根目录下。</li><li class="listitem">在 web 服务器上的 <code class="filename">php.ini</code> 配置文件中，分别将 <code class="filename">PHPUnit/Extensions/SeleniumCommon/prepend.php</code> 和 <code class="filename">PHPUnit/Extensions/SeleniumCommon/append.php</code> 配置为 <code class="literal">auto_prepend_file</code> 和 <code class="literal">auto_append_file</code>。</li><li class="listitem">在扩展自 <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> 的测试用例类中，用 <pre class="programlisting">protected $coverageScriptUrl = 'http://host/phpunit_coverage.php';</pre> 来配置 <code class="filename">phpunit_coverage.php</code> 脚本所在的 URL。</li></ol></div><p>
      <a class="xref" href="selenium.html#selenium.seleniumtestcase.tables.assertions" title="表 13.2. 断言">表 13.2</a> 列出了 <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> 所提供的各种断言方法。</p><div class="table"><a id="selenium.seleniumtestcase.tables.assertions"></a><p class="title"><strong>表 13.2. 断言</strong></p><div class="table-contents"><table summary="断言" border="1"><colgroup><col></col><col></col></colgroup><thead><tr><th align="left">断言</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left"><code class="literal">void assertElementValueEquals(string $locator, string $text)</code></td><td align="left">当由 <code class="literal">$locator</code> 所标识的元素的值与给定的 <code class="literal">$text</code>不等时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertElementValueNotEquals(string $locator, string $text)</code></td><td align="left">当由 <code class="literal">$locator</code> 所标识的元素的值与给定的 <code class="literal">$text</code>相等时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertElementValueContains(string $locator, string $text)</code></td><td align="left">当由 <code class="literal">$locator</code> 所标识的元素的值不包含给定的 <code class="literal">$text</code>时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertElementValueNotContains(string $locator, string $text)</code></td><td align="left">当由 <code class="literal">$locator</code> 所标识的元素的值包含给定的 <code class="literal">$text</code>时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertElementContainsText(string $locator, string $text)</code></td><td align="left">当由 <code class="literal">$locator</code> 所标识的元素不包含给定的 <code class="literal">$text</code>时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertElementNotContainsText(string $locator, string $text)</code></td><td align="left">当由 <code class="literal">$locator</code> 所标识的元素包含给定的 <code class="literal">$text</code>时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertSelectHasOption(string $selectLocator, string $option)</code></td><td align="left">当给定的选项不可用时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertSelectNotHasOption(string $selectLocator, string $option)</code></td><td align="left">当给定的选项可用时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertSelected($selectLocator, $option)</code></td><td align="left">当给定的标签未被选定时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertNotSelected($selectLocator, $option)</code></td><td align="left">当给定的标签被选定时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertIsSelected(string $selectLocator, string $value)</code></td><td align="left">当给定的值未被选定时报告错误。</td></tr><tr><td align="left"><code class="literal">void assertIsNotSelected(string $selectLocator, string $value)</code></td><td align="left">当给定的值被选定时报告一个错误。</td></tr></tbody></table></div></div><br class="table-break"></br><p>
      <a class="xref" href="selenium.html#selenium.seleniumtestcase.tables.template-methods" title="表 13.3. 模板方法">表 13.3</a>列出了 <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> 的模板方法：</p><div class="table"><a id="selenium.seleniumtestcase.tables.template-methods"></a><p class="title"><strong>表 13.3. 模板方法</strong></p><div class="table-contents"><table summary="模板方法" border="1"><colgroup><col></col><col></col></colgroup><thead><tr><th align="left">方法</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left"><code class="literal">void defaultAssertions()</code></td><td align="left">覆盖本方法来为所有测试用例中的测试执行公用断言。每次向 Selenium Server 服务器发送命令之后都会调用本方法。</td></tr></tbody></table></div></div><br class="table-break"></br><p>请查看 <a class="ulink" href="http://release.seleniumhq.org/selenium-core/1.0.1/reference.html" target="_top">Selenium 命令文档</a>来获得所有可用的命令的参考以及它们的使用方法。</p><p>Selenium 1 命令是通过 __call 来动态实现的。请查看 <a class="ulink" href="https://github.com/sebastianbergmann/phpunit-selenium/blob/master/PHPUnit/Extensions/SeleniumTestCase/Driver.php#L410" target="_top">PHPUnit_Extensions_SeleniumTestCase_Driver::__call() 的 API 文档</a> 来获取所有 PHP 侧所支持的所有方法的列表以及它们的参数和返回类型。</p><p>通过使用 <code class="literal">runSelenese($filename)</code> 方法，可以从 Selenese/HTML 规格来运行 Selenium 测试。此外，通过使用静态属性 <code class="literal">$seleneseDirectory</code>，可以从包含 Selenese/HTML 文件的目录里自动创建测试对象。PHPUnit 会在指定的目录中的递归查找 <code class="literal">.htm</code> 文件，并预期这些文件内含 Selenese/HTML。<a class="xref" href="selenium.html#selenium.seleniumtestcase.examples.WebTest4.php" title="例 13.5: 用包含 Selenese/HTML 文件的目录作为测试">例 13.5</a> 展示了例子。</p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest4.php"></a><p class="title"><strong>例 13.5: 用包含 Selenese/HTML 文件的目录作为测试</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class SeleneseTests extends PHPUnit_Extensions_SeleniumTestCase
{
    public static $seleneseDirectory = '/path/to/files';
}
?&gt;</pre></div></div><br class="example-break"></br><p>从 Selenium 1.1.1 开始，包含了一个实验性的特性，允许用户在不同测试之间共享会话(session)。唯一支持的情况是当使用单个浏览器时在所有测试间共享会话。在初始启动(bootstrap)文件中调用 <code class="literal">PHPUnit_Extensions_SeleniumTestCase::shareSession(true)</code> 来启用会话共享。在碰到不成功的测试（失败或不完整）时会话将会重置；用户自行决定如何避免测试之间的互动，可以重设 cookies 或者从被测应用程序登出（通过 tearDown() 方法）。</p></div></div>
     <div class="row">
      <div class="col-md-1 pull-left prev-nav"><a accesskey="p" href="other-uses-for-tests.html">上一章</a></div>
      <div class="col-md-1 pull-right next-nav"><a accesskey="n" href="logging.html">下一章</a></div>
     </div>
<div class="row"><div class="col-md-2"></div><div class="col-md-8"><div class="alert alert-info" style="text-align: center;">如果对本页有改进建议，请 <a href="https://github.com/sebastianbergmann/phpunit-documentation/issues">在 GitHub 上开启任务单</a>。万分感谢！</div></div><div class="col-md-2"></div></div>
    </div>
   </div>
   <hr/>
   <footer>
    <p><a href="appendixes.copyright.html">Copyright</a> &copy; 2005-2015 <a href="http://sebastian-bergmann.de/">Sebastian Bergmann</a>.</p>
   </footer>
  </div>
  <script src="js/jquery.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/highlight.pack.js"></script>
  <script type="text/javascript">
  $(document).ready(function() { $('pre.programlisting').each(function(i, e) {hljs.highlightBlock(e)}); });

  var _paq = _paq || [];
  _paq.push(["trackPageView"]);
  _paq.push(["enableLinkTracking"]);

  (function() {
    var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.sebastian-bergmann.de/";
    _paq.push(["setTrackerUrl", u+"piwik.php"]);
    _paq.push(["setSiteId", "2"]);
    var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
    g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
  })();
  </script>
 </body>
</html>
